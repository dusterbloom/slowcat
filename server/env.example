OPENAI_API_KEY=""
DEEPGRAM_API_KEY=""
RIME_API_KEY=""

# =============================
# Simplified controls (recommended)
# =============================
# MEMORY_BACKEND: sqlite | surreal | stateless
MEMORY_BACKEND="sqlite"

# GREETING_MODE: pipeline | model | off
# - pipeline: inject one greeting then suppress model greetings (recommended)
# - model: let the model greet on its own
# - off: never greet
GREETING_MODE="pipeline"

# FACTS_PROMPT_STYLE: clean | raw
# - clean: include only user facts, hide name, normalize phrasing
# - raw: include all subjects, include name
FACTS_PROMPT_STYLE="clean"

# RESPONSE_FORMATTER_MODE: off | minimal | full
# - off: no changes to assistant text (best for TTS)
# - minimal: collapse letter-split names (e.g., 'P eppy' -> 'Peppy')
# - full: minimal + link conversion + spacing fixes
RESPONSE_FORMATTER_MODE="off"

# =============================
# Detailed controls (advanced)
# =============================

# Audio & Voice Processing
ENABLE_SMART_TURN_MANAGEMENT="true"  # Enable intelligent turn-taking to reduce interruptions

# ðŸ”¥ STT Configuration
STT_BACKEND="sherpa-onnx"  # or "whisper-mlx"

# ðŸš€ STREAMING SHERPA-ONNX Configuration
SHERPA_STREAMING="true"                # Enable streaming mode (vs segmented)
SHERPA_ONLINE_STREAMING="true"         # Use OnlineRecognizer (true) vs legacy streaming
SHERPA_ONNX_MODEL_DIR="models/kroko-asr-en"  # Path to Sherpa model dir with .onnx and tokens.txt
SHERPA_DECODING_METHOD="greedy_search" # Decoding method
SHERPA_PROVIDER="cpu"                  # Inference provider

# Online streaming (v2) tuning
SHERPA_CHUNK_MS="200"                  # Online chunk size (ms)
SHERPA_MAX_PATHS="8"                   # Max active paths for decoding
SHERPA_THREADS="1"                     # Inference threads
SHERPA_ENDPOINT_DETECTION="true"       # Use endpoint detection
SHERPA_RULE1_MIN_TRAILING_SILENCE="1.5"   # Endpoint rule 1 (s)
SHERPA_RULE2_MIN_TRAILING_SILENCE="1.0"    # Endpoint rule 2 (s)
SHERPA_RULE3_MIN_UTTERANCE_LENGTH="300"    # Endpoint rule 3 (ms)

# Punctuation (CT-Transformer)
SHERPA_ENABLE_PUNCTUATION="true"       # Add punctuation on finals
SHERPA_PUNCTUATION_MODEL_DIR="models/sherpa/punctuation/sherpa-onnx-punct-ct-transformer-zh-en-vocab272727-2024-04-12"

# Interim logs (optional)
SHERPA_PARTIAL_RESULTS="false"         # Emit InterimTranscriptionFrame
SHERPA_LOG_INTERIM="false"             # Log interim text

# Legacy Segmented Mode (when SHERPA_STREAMING="false")
SHERPA_HOTWORDS_FILE=""                # Optional hotwords file
SHERPA_HOTWORDS_SCORE="1.5"            # Hotwords boost score
SHERPA_LANGUAGE_LOCK=""                # Force specific language
SHERPA_LANGUAGE_LOCK_MODE="strict"     # Language lock mode

# Final emission guard (v2): prevents premature finals from punctuation endpoints
SHERPA_MIN_FINAL_WORDS="4"              # If endpoint text shorter than this and not ?/!, hold briefly
SHERPA_ENDPOINT_DEBOUNCE_MS="350"       # Hold duration for short finals (ms)

# Pipeline idle behavior
PIPELINE_IDLE_TIMEOUT_SECS="0"          # 0 disables idle cancellation; set seconds to enable

# Identity and persistence
# (Optional) Single logical user id to use when speaker recognition is disabled
USER_ID=""                              # e.g., "peppi" (empty = auto)
# Absolute path to facts DB for persistence across runs
FACTS_DB_PATH=""                        # e.g., "/Users/you/slowcat/data/facts.db"

# SmartContextManager feature toggles (opt-in)
ENABLE_SPELLING_HINTS="false"           # Detect spelled-out names and add hints to reduce loops
ENABLE_LOCATION_SPELLING_HINTS="false"  # Stronger hints when discussing locations/town names
ENABLE_GREETING_FALLBACK="false"        # If previous summary is too noisy, start with a simple "Hello!"

# TapeStore noise guard (defaults enforce: questions OR >=3 words OR >=15 chars)
TAPE_MIN_USEFUL_WORDS="3"               # Minimum alpha words to persist a turn (0 disables word threshold)
TAPE_MIN_USEFUL_LEN="15"                # Minimum character length to persist a turn (0 disables length threshold)

# SurrealDB memory (optional)
# Toggle SurrealDB multi-model memory. Alias: USE_SLOWCAT_MEMORY=true
USE_SURREALDB="false"                  # Set to "true" to use SurrealDB instead of SQLite
SURREALDB_URL="ws://127.0.0.1:8000/rpc" # SurrealDB connection URL
SURREALDB_USER="root"                 # SurrealDB username
SURREALDB_PASS="slowcat_secure_2024"  # SurrealDB password
SURREALDB_NAMESPACE="slowcat"         # SurrealDB namespace
SURREALDB_DATABASE="memory"           # SurrealDB database name

# Prompt context tuning
# Only include facts where subject == 'user' in the prompt facts block
FACTS_ONLY_USER_SUBJECT="true"
# Include the user's name fact in the facts prompt block (default: false).
# Name is still used for greeting even if excluded here.
INCLUDE_NAME_IN_FACTS="false"
# Phrasing for location facts, used in facts block
# Examples: "are located in" (default), "are in", "live in"
FACTS_LOCATION_PHRASE="are located in"

# Deterministic greeting injection (pipeline will greet once on connect)
# Set to "true" to inject a single greeting and instruct the model not to greet.
SC_ENFORCE_GREETING="false"
SC_SUPPRESS_ASSISTANT_GREETINGS="true"
